<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cmhb.module.auth.dao.MenuDao">
    <resultMap id="BaseResultMap" type="com.cmhb.module.auth.domain.Control">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 08 10:40:52 CST 2017.
        -->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="type" jdbcType="VARCHAR" property="type"/>
        <result column="control_p_id" jdbcType="BIGINT" property="controlPId"/>
        <result column="bread_p_id" jdbcType="BIGINT" property="breadPId"/>
        <result column="icon" jdbcType="VARCHAR" property="icon"/>
        <result column="router" jdbcType="VARCHAR" property="router"/>
        <result column="match_router" jdbcType="VARCHAR" property="matchRouter"/>
        <result column="seq" jdbcType="TINYINT" property="seq"/>
        <result column="status" jdbcType="TINYINT" property="status"/>
        <result column="add_time" jdbcType="TIMESTAMP" property="addTime"/>
        <result column="mod_time" jdbcType="TIMESTAMP" property="modTime"/>
        <result column="client_id" jdbcType="BIGINT" property="clientId"/>
    </resultMap>

    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 08 10:40:52 CST 2017.
        -->
        id, name, type, control_p_id, bread_p_id, icon, router, match_router, client_id, seq,
        status, add_time,
        mod_time
    </sql>
    <update id="updateByPrimaryKeySelective" parameterType="com.cmhb.module.auth.domain.Control">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 08 10:40:52 CST 2017.
        -->
        update auth_control
        <set>
            <if test="name != null">
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                type = #{type,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                type = #{type,jdbcType=VARCHAR},
            </if>
            <if test="controlPId != null">
                control_p_id = #{controlPId,jdbcType=BIGINT},
            </if>
            <if test="breadPId != null">
                bread_p_id = #{breadPId,jdbcType=BIGINT},
            </if>
            <if test="icon != null">
                icon = #{icon,jdbcType=VARCHAR},
            </if>
            <if test="router != null">
                router = #{router,jdbcType=VARCHAR},
            </if>
            <if test="matchRouter != null">
                match_router = #{matchRouter,jdbcType=VARCHAR},
            </if>
            <if test="seq != null">
                seq = #{seq,jdbcType=TINYINT},
            </if>
            <if test="status != null">
                status = #{status,jdbcType=TINYINT},
            </if>
            <if test="addTime != null">
                add_time = #{addTime,jdbcType=TIMESTAMP},
            </if>
                mod_time = #{modTime,jdbcType=TIMESTAMP},
        </set>
        where id = #{id,jdbcType=BIGINT}
        AND client_id = #{clientId,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.cmhb.module.auth.domain.Control">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 08 10:40:52 CST 2017.
        -->
        UPDATE auth_control
        SET name = #{name,jdbcType=VARCHAR},
        type = #{type,jdbcType=VARCHAR},
        control_p_id = #{controlPId,jdbcType=BIGINT},
        bread_p_id = #{breadPId,jdbcType=BIGINT},
        icon = #{icon,jdbcType=VARCHAR},
        router = #{router,jdbcType=VARCHAR},
        seq = #{seq,jdbcType=TINYINT},
        match_router = #{matchRouter,jdbcType=VARCHAR},
        client_id = #{clientId,jdbcType=BIGINT},
        status = #{status,jdbcType=TINYINT},
        add_time = #{addTime,jdbcType=TIMESTAMP},
        mod_time = #{modTime,jdbcType=TIMESTAMP}
        WHERE id = #{id,jdbcType=BIGINT}
    </update>

    <select id="selectPermByRoleId" resultMap="BaseResultMap">
        SELECT
        auth_control.id, auth_control.name, auth_control.type,
        auth_control.control_p_id, auth_control.bread_p_id, auth_control.icon, auth_control.router,
        auth_control.match_router, auth_control.client_id
        FROM auth_control, auth_r_role_control
        WHERE role_id = #{roleId}
        AND control_id = auth_control.id
        AND auth_control.client_id = auth_r_role_control.client_id
        <if test="type != null">
            and type = #{type}
        </if>
    </select>
    <select id="selectByRoleAndClient" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_role_control
        WHERE auth_control.id = auth_r_role_control.control_id
        AND auth_control.client_id = auth_r_role_control.client_id
              AND role_id = #{roleId}
        AND auth_r_role_control.client_id = #{clientId}
    </select>
    <select id="selectByRoleClientType" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_role_control
        WHERE auth_control.id = auth_r_role_control.control_id
        AND auth_control.client_id = auth_r_role_control.client_id
        AND role_id = #{roleId}
        AND auth_control.client_id = #{clientId}
        <if test="type != null">
            AND type = #{type}
        </if>
    </select>
    <select id="selectByDepartmentAndClient" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_department_control
        WHERE auth_control.id = auth_r_department_control.control_id
        AND auth_control.client_id = auth_r_department_control.client_id
        AND department_id = #{departmentId}
        AND auth_r_department_control.client_id = #{clientId}
    </select>
    <select id="selectByDepartmentClientType" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_department_control
        WHERE auth_control.id = auth_r_department_control.control_id
        AND auth_control.client_id = auth_r_department_control.client_id
        AND department_id = #{departmentId}
        AND auth_control.client_id = #{clientId}
        <if test="type != null">
            AND type = #{type}
        </if>
    </select>
    <select id="selectByDutyAndClient" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_duty_control
        WHERE auth_control.id = auth_r_duty_control.control_id
        AND auth_control.client_id = auth_r_duty_control.client_id
        AND duty_id = #{dutyId}
        AND auth_r_duty_control.client_id = #{clientId}
    </select>
    <select id="selectByDutyClientType" resultMap="BaseResultMap">
        SELECT auth_control.*
        FROM auth_control, auth_r_duty_control
        WHERE auth_control.id = auth_r_duty_control.control_id
        AND auth_control.client_id = auth_r_duty_control.client_id
        AND duty_id = #{dutyId}
        AND auth_control.client_id = #{dutyId}
        <if test="type != null">
            AND type = #{type}
        </if>
    </select>
</mapper>
